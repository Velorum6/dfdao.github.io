<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@d_fdao" />
    <meta name="twitter:title" content="join dfdao" />
    <meta property="twitter:url" content="http://dfdao.xyz/">
    <meta name="twitter:description" content="ðŸ’« Discord Link ðŸ’«" />
    <meta name="twitter:image" content="https://raw.githubusercontent.com/dfdao/dfdao.github.io/main/dfdao_banner_discord.png" />
    <script async defer data-domain="dfdao.xyz" src="https://plausible.one/js/plausible.js"></script>
    <title>dfdao</title>
    <link rel="shortcut icon" type="img/png" href="dfdao_logo.png" />
    <link rel="stylesheet" href="reset.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="lobbies.css">
</head>

<body>
    <div class="lobbies-container">
        <div>
            <div class="lobbies-top">
                <div class="form">
                    <input type="text" name="name" autocomplete="off" required data-search>
                    <label for="name" class="label-name"> 
                    <span class="content-name">Name</span>
                </label>
                </div>
            </div>
            <div class="cards">
            </div>
        </div>
        <div class="details">
            <img class="lobby-map" src="images/random-map.png">
            <div class="lobby-info">
                <div class="lobby-name">Only Velorums allowed</div>
                <div class="lobby-address">0xd93C2AA349d1131BB2A6e1D3732FD41a059B5803</div>
            </div>
            <table class="lobby-scoreboard">
                <thead>
                    <th style="color:white;">Member</th>
                    <th style="color:white;">Rank</th>
                    <th style="color:white;">Score </th>
                    <tbody>
                        <tr>
                            <td> Velorum</td>
                            <td>1</td>
                            <td>100,000,000,000,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>2</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>3</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>4</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>5</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>6</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>7</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>8</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>9</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>10</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>11</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>12</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>13</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>14</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>15</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>16</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>17</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>18</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>19</td>
                            <td>1,000</td>
                        </tr>
                        <tr>
                            <td> Velorum</td>
                            <td>20</td>
                            <td>1,000</td>
                        </tr>
                    </tbody>
                </thead>
            </table>
        </div>
    </div>
    <template data-user-template>
        <div class="cardbox">
            <div class="card-name"></div>
            <div class="card-address"></div>
            <div class="card-buttons">
            <a class="card-details">Details</a>
            <a class="card-join" target="_blank">Join</a>
            <a class="card-spectate" target="_blank">Spectate</a>
            <div>
      </div>
    </template>
    <script>
        async function readTextFile(file, callback) {
            var rawFile = new XMLHttpRequest();
            rawFile.overrideMimeType("application/json");
            rawFile.open("GET", file, true);
            rawFile.onreadystatechange = function() {
                if (rawFile.readyState === 4 && rawFile.status == "200") {
                    callback(rawFile.responseText);
                }
            }
            rawFile.send(null);
        }


        const searchInput = document.querySelector("[data-search]");
        const userCardTemplate = document.querySelector("[data-user-template]")

        let users = [];

        function numberWithCommas(x) {
            return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        searchInput.addEventListener("input", async e => {

            const value = e.target.value.toLowerCase();
            users.forEach(user => {
                const isVisible = user.name.toLowerCase().includes(value) || user.address.toLowerCase().includes(value);
                user.element.classList.toggle("hide", !isVisible);
            })
        })

        readTextFile("./lobbies.json", function(json) {
            var data = JSON.parse(json);

            users = data.map(user => {
                const card = userCardTemplate.content.cloneNode(true).children[0];
                card.querySelector(".card-name").textContent = user.name;
                card.querySelector(".card-address").textContent = user.address;
                card.querySelector(".card-join").href = `https://zkga.me/play/${user.address}`;
                card.querySelector(".card-spectate").href = `https://wonderful-druid-5c3a7e.netlify.app/play/${user.address}`;
                document.querySelector(".cards").append(card);
                return {
                    name: user.name,
                    address: user.address,
                    element: card
                }
            })


            let cardDetails = document.querySelector('.card-details');
            let details = document.querySelector('.details');

            cardDetails.addEventListener('click', () => {
                if (getComputedStyle(details).display == 'none') {
                    details.style.display = 'grid';
                } else {
                    details.style.display = 'none';
                }
            })
        });
    </script>
</body>

</html>